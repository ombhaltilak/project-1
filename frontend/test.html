<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>AI.Tech - Artificial Intelligence HTML Template</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Ubuntu:wght@500;700&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
</head>

<body>
    <!-- Spinner Start -->
    <div id="spinner" class="d-none bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-grow text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <!-- Spinner End -->

    <!-- Navbar Start -->
    <div class="container-fluid sticky-top">
        <div class="container">
            <nav class="navbar navbar-expand-lg navbar-dark p-0">
                <a href="index.html" class="navbar-brand">
                    <h1 class="text-white">AI<span class="text-dark">.</span>Tech</h1>
                </a>
                <button type="button" class="navbar-toggler ms-auto me-0" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <div class="navbar-nav ms-auto">
                        <a href="index.html" class="nav-item nav-link">Home</a>
                        <a href="about.html" class="nav-item nav-link">About</a>
                        <a href="service.html" class="nav-item nav-link active">Services</a>
                        <a href="project.html" class="nav-item nav-link">Projects</a>
                        <div class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Pages</a>
                            <div class="dropdown-menu bg-light mt-2">
                                <a href="feature.html" class="dropdown-item">Features</a>
                                <a href="team.html" class="dropdown-item">Our Team</a>
                                <a href="faq.html" class="dropdown-item">FAQs</a>
                                <a href="testimonial.html" class="dropdown-item">Testimonial</a>
                                <a href="404.html" class="dropdown-item">404 Page</a>
                            </div>
                        </div>
                        <a href="contact.html" class="nav-item nav-link">Contact</a>
                    </div>
                    <button type="button" class="btn text-white p-0 d-none d-lg-block" data-bs-toggle="modal" data-bs-target="#searchModal"><i class="fa fa-search"></i></button>
                </div>
            </nav>
        </div>
    </div>
    <!-- Navbar End -->

    <!-- Hero Start -->
    <div class="container-fluid pt-5 bg-primary hero-header">
        <div class="container pt-5">
            <div class="row g-5 pt-5">
                <div class="col-lg-6 align-self-center text-center text-lg-start mb-lg-5">
                    <h1 class="display-4 text-white mb-4 animated slideInRight">Our Services</h1>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb justify-content-center justify-content-lg-start mb-0">
                            <li class="breadcrumb-item"><a class="text-white" href="#">Home</a></li>
                            <li class="breadcrumb-item"><a class="text-white" href="#">Pages</a></li>
                            <li class="breadcrumb-item text-white active" aria-current="page">Our Services</li>
                        </ol>
                    </nav>
                </div>
                <div class="col-lg-6 align-self-end text-center text-lg-end">
                    <img class="img-fluid" src="img/hero-img.png" alt="" style="max-height: 300px;">
                </div>
            </div>
        </div>
    </div>
    <!-- Hero End -->

    <!-- Full Screen Search Start -->
    <div class="modal fade" id="searchModal" tabindex="-1">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content" style="background: rgba(20, 24, 62, 0.7);">
                <div class="modal-header border-0">
                    <button type="button" class="btn btn-square bg-white btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body d-flex align-items-center justify-content-center">
                    <div class="input-group" style="max-width: 600px;">
                        <input type="text" class="form-control bg-transparent border-light p-3" placeholder="Type search keyword">
                        <button class="btn btn-light px-4"><i class="bi bi-search"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Full Screen Search End -->

    <!-- Service Start -->
    <div class="container-fluid bg-light py-5">
        <div class="container py-5">
            <!-- File Upload Section -->
            <div class="row mb-5">
                <div class="col-lg-8 wow fadeIn" data-wow-delay="0.1s">
                    <div class="btn btn-sm border rounded-pill text-primary px-3 mb-3">Our Services</div>
                    <h1 class="mb-4">Aadhar Fraud Management System</h1>
                    <p class="mb-4">Secure your Aadhar ecosystem with our AI-powered verification system. Upload required files to initiate automated fraud detection and validation process.</p>
                    
                    <!-- Form for File Upload -->
                    <form id="uploadForm" enctype="multipart/form-data">
                        <div class="row g-4">
                            <!-- Horizontal File Inputs -->
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Upload ZIP File (Images)</label>
                                <input type="file" class="form-control rounded-pill" name="zipFile" accept=".zip" required>
                                
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Upload Excel File (Mapping)</label>
                                <input type="file" class="form-control rounded-pill" name="excelFile" accept=".xlsx, .xls" required>
                            </div>
                            
                            <!-- Start Button -->
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary rounded-pill w-100 py-2">
                                    <i class="fa fa-play-circle me-2"></i>Start Verification
                                </button>
                            </div>
                        </div>
                    </form>

                    <!-- Download Section (Hidden by Default) -->
                    <div id="downloadSection" class="mt-4" style="display: none;">
                        <h5 class="mb-3">Processed File Ready for Download</h5>
                        <a id="downloadLink" class="btn btn-success rounded-pill w-100 py-2">
                            <i class="fa fa-download me-2"></i>Download Processed File
                        </a>
                    </div>
                </div>
            </div>

            <!-- Vertical Chart Sections -->
            <div class="row g-4">
                <!-- Aadhaar vs Non-Aadhaar -->
                <div class="col-12 wow fadeIn" data-wow-delay="0.2s">
                    <div class="card border-0 shadow h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="card-title mb-0">Aadhaar vs Non-Aadhaar Distribution</h5>
                                <button class="btn btn-outline-primary">
                                    <i class="fa fa-download me-2"></i>Download Report
                                </button>
                            </div>
                            <div style="height: 300px">
                                <canvas id="barChart1"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Non-Aadhaar vs Aadhaar -->
                <div class="col-12 wow fadeIn" data-wow-delay="0.4s">
                    <div class="card border-0 shadow h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="card-title mb-0">Comparative Analysis</h5>
                                <button class="btn btn-outline-primary">
                                    <i class="fa fa-download me-2"></i>Download Report
                                </button>
                            </div>
                            <div style="height: 300px">
                                <canvas id="barChart2"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pie Chart Section -->
                <div class="col-12 wow fadeIn" data-wow-delay="0.6s">
                    <div class="card border-0 shadow h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="card-title mb-0">Document Status Distribution</h5>
                                <button class="btn btn-outline-primary">
                                    <i class="fa fa-download me-2"></i>Download Report
                                </button>
                            </div>
                            <div style="height: 300px">
                                <canvas id="pieChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Table Section -->
            <div class="row mt-5 wow fadeIn" data-wow-delay="0.8s">
                <div class="col-12">
                    <div class="card border-0 shadow">
                        <div id="resultsSection" class="card-body d-none">
                            <h5 class="card-title mb-4">Verification Results</h5>
                            <div class="table-responsive">
                                <table id="verificationTable" class="table table-bordered table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Sr. No</th>
                                            <th>Accept/Reject Status</th>
                                            <th>Document Type</th>
                                            <th>Final Remark</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Results will be dynamically populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Service End -->

    <!-- Testimonial Start -->
    <div class="container-xxl py-5">
        <div class="container py-5">
            <div class="row g-5">
                <div class="col-lg-5 wow fadeIn" data-wow-delay="0.1s">
                    <div class="btn btn-sm border rounded-pill text-primary px-3 mb-3">Testimonial</div>
                    <h1 class="mb-4">What Say Our Clients!</h1>
                    <p class="mb-4">Tempor erat elitr rebum at clita. Diam dolor diam ipsum et tempor sit. Aliqu diam amet diam et eos labore. Clita erat ipsum et lorem et sit, sed stet no labore lorem sit. Sanctus clita duo justo et tempor eirmod magna dolore erat amet</p>
                    <a class="btn btn-primary rounded-pill px-4" href="">Read More</a>
                </div>
                <div class="col-lg-7 wow fadeIn" data-wow-delay="0.5s">
                    <div class="owl-carousel testimonial-carousel border-start border-primary">
                        <div class="testimonial-item ps-5">
                            <i class="fa fa-quote-left fa-2x text-primary mb-3"></i>
                            <p class="fs-4">Aliqu diam amet diam et eos labore. Clita erat ipsum et lorem et sit, sed stet no labore lorem sit. Sanctus clita duo justo et tempor eirmod magna dolore erat amet</p>
                            <div class="d-flex align-items-center">
                                <img class="img-fluid flex-shrink-0 rounded-circle" src="img/testimonial-1.jpg" style="width: 60px; height: 60px;">
                                <div class="ps-3">
                                    <h5 class="mb-1">Client Name</h5>
                                    <span>Profession</span>
                                </div>
                            </div>
                        </div>
                        <div class="testimonial-item ps-5">
                            <i class="fa fa-quote-left fa-2x text-primary mb-3"></i>
                            <p class="fs-4">Aliqu diam amet diam et eos labore. Clita erat ipsum et lorem et sit, sed stet no labore lorem sit. Sanctus clita duo justo et tempor eirmod magna dolore erat amet</p>
                            <div class="d-flex align-items-center">
                                <img class="img-fluid flex-shrink-0 rounded-circle" src="img/testimonial-2.jpg" style="width: 60px; height: 60px;">
                                <div class="ps-3">
                                    <h5 class="mb-1">Client Name</h5>
                                    <span>Profession</span>
                                </div>
                            </div>
                        </div>
                        <div class="testimonial-item ps-5">
                            <i class="fa fa-quote-left fa-2x text-primary mb-3"></i>
                            <p class="fs-4">Aliqu diam amet diam et eos labore. Clita erat ipsum et lorem et sit, sed stet no labore lorem sit. Sanctus clita duo justo et tempor eirmod magna dolore erat amet</p>
                            <div class="d-flex align-items-center">
                                <img class="img-fluid flex-shrink-0 rounded-circle" src="img/testimonial-3.jpg" style="width: 60px; height: 60px;">
                                <div class="ps-3">
                                    <h5 class="mb-1">Client Name</h5>
                                    <span>Profession</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Testimonial End -->

    <!-- Newsletter Start -->
    <div class="container-fluid bg-primary newsletter py-5">
        <div class="container">
            <div class="row g-5 align-items-center">
                <div class="col-md-5 ps-lg-0 pt-5 pt-md-0 text-start wow fadeIn" data-wow-delay="0.3s">
                    <img class="img-fluid" src="img/newsletter.png" alt="">
                </div>
                <div class="col-md-7 py-5 newsletter-text wow fadeIn" data-wow-delay="0.5s">
                    <div class="btn btn-sm border rounded-pill text-white px-3 mb-3">Newsletter</div>
                    <h1 class="text-white mb-4">Let's subscribe the newsletter</h1>
                    <div class="position-relative w-100 mt-3 mb-2">
                        <input class="form-control border-0 rounded-pill w-100 ps-4 pe-5" type="text" placeholder="Enter Your Email" style="height: 48px;">
                        <button type="button" class="btn shadow-none position-absolute top-0 end-0 mt-1 me-2"><i class="fa fa-paper-plane text-primary fs-4"></i></button>
                    </div>
                    <small class="text-white-50">Diam sed sed dolor stet amet eirmod</small>
                </div>
            </div>
        </div>
    </div>
    <!-- Newsletter End -->

    <!-- Footer Start -->
    <div class="container-fluid bg-dark text-white-50 footer pt-5">
        <div class="container py-5">
            <div class="row g-5">
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.1s">
                    <a href="index.html" class="d-inline-block mb-3">
                        <h1 class="text-white">AI<span class="text-primary">.</span>Tech</h1>
                    </a>
                    <p class="mb-0">The AI-Based Fraud Management System for UID Aadhaar is a cutting-edge solution designed to safeguard India's Aadhaar ecosystem by leveraging advanced artificial intelligence technologies, including machine learning algorithms, computer vision, and predictive analytics.</p>
                </div>
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.3s">
                    <h5 class="text-white mb-4">Get In Touch</h5>
                    <p><i class="fa fa-map-marker-alt me-3"></i>123 Street, New York, USA</p>
                    <p><i class="fa fa-phone-alt me-3"></i>+012 345 67890</p>
                    <p><i class="fa fa-envelope me-3"></i>info@example.com</p>
                    <div class="d-flex pt-2">
                        <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-twitter"></i></a>
                        <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-facebook-f"></i></a>
                        <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-youtube"></i></a>
                        <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-instagram"></i></a>
                        <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.5s">
                    <h5 class="text-white mb-4">Popular Link</h5>
                    <a class="btn btn-link" href="about.html">About Us</a>
                    <a class="btn btn-link" href="contact.html">Contact Us</a>
                    <a class="btn btn-link" href="">Privacy Policy</a>
                    <a class="btn btn-link" href="">Terms & Condition</a>
                    <a class="btn btn-link" href="">Career</a>
                </div>
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.7s">
                    <h5 class="text-white mb-4">Our Services</h5>
                    <a class="btn btn-link" href="">Robotic Automation</a>
                    <a class="btn btn-link" href="">Machine learning</a>
                    <a class="btn btn-link" href="">Predictive Analysis</a>
                    <a class="btn btn-link" href="">Data Science</a>
                    <a class="btn btn-link" href="">Robot Technology</a>
                </div>
            </div>
        </div>
        <div class="container wow fadeIn" data-wow-delay="0.1s">
            <div class="copyright">
                <div class="row">
                    <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                        © <a class="border-bottom" href="#">AI.Tech</a>, All Right Reserved.
                        Designed By <a class="border-bottom" href="https://htmlcodex.com">HTML Codex</a>
                    </div>
                    <div class="col-md-6 text-center text-md-end">
                        <div class="footer-menu">
                            <a href="index.html">Home</a>
                            <a href="">Cookies</a>
                            <a href="">Help</a>
                            <a href="">FAQs</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top pt-2"><i class="bi bi-arrow-up"></i></a>

    <!-- JavaScript Libraries -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/counterup/counterup.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- JavaScript for Form Submission -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('uploadForm').addEventListener('submit', function (e) {
        e.preventDefault(); // Prevent default form submission (stops page refresh)
        console.log('Form submission intercepted');

        // Show spinner
        document.getElementById('spinner').classList.remove('d-none');
        console.log('Spinner shown');

        // Collect form data
        const formData = new FormData(this);
        console.log('Form data prepared:');
        for (let [key, value] of formData.entries()) {
            console.log(`${key}: ${value.name || value}`); // Log file names or values
        }

        // Check if required files are present
        if (!formData.has('zipFile') || !formData.has('excelFile')) {
            console.error('Missing files in form data');
            document.getElementById('spinner').classList.add('d-none');
            alert('Please upload both a ZIP file and an Excel file.');
            return;
        }

        // Send fetch request to the backend
        fetch('http://127.0.0.1:5000/process-files', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            console.log('Response status:', response.status); // Log HTTP status
            if (!response.ok) {
                // Extract detailed error message from server response
                return response.text().then(text => {
                    throw new Error(`Server error: ${text || response.statusText}`);
                });
            }
            return response.json(); // Parse successful response as JSON
        })
        .then(data => {
            console.log('Processing results:', data); // Log server response data
            document.getElementById('spinner').classList.add('d-none');

            // Clear previous table results
            const tbody = document.querySelector('#verificationTable tbody');
            tbody.innerHTML = '';

            // Populate table with new results
            data.forEach((item, index) => {
                const row = tbody.insertRow();
                row.insertCell().textContent = index + 1;

                const statusCell = row.insertCell();
                const statusBadge = document.createElement('span');
                statusBadge.className = item.status === 'Verified' ? 'badge bg-success' : 'badge bg-danger';
                statusBadge.textContent = item.status;
                statusCell.appendChild(statusBadge);

                row.insertCell().textContent = item.file || 'N/A';
                row.insertCell().textContent = item.reason || (item.status === 'Verified' ? 'Validation Successful' : 'Validation Failed');
            });

            // Show results section
            document.getElementById('resultsSection').classList.remove('d-none');
            console.log('Table populated and results section shown');
        })
        .catch(error => {
            console.error('Fetch error:', error.message); // Log detailed error
            document.getElementById('spinner').classList.add('d-none');
            alert('Error processing files: ' + error.message); // Show user-friendly error
        });
    });
});
    </script>

    <!-- Chart.js Implementation --> 
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Bar Chart 1
        new Chart(document.getElementById('barChart1'), {
            type: 'bar',
            data: {
                labels: ['Aadhaar', 'Non-Aadhaar'],
                datasets: [{
                    label: 'Percentage',
                    data: [68, 32],
                    backgroundColor: ['#3b82f6', '#10b981']
                }]
            }
        });

        // Bar Chart 2
        new Chart(document.getElementById('barChart2'), {
            type: 'bar',
            data: {
                labels: ['Valid', 'Suspicious', 'Invalid'],
                datasets: [{
                    label: 'Documents',
                    data: [1200, 150, 50],
                    backgroundColor: ['#3b82f6', '#f59e0b', '#ef4444']
                }]
            }
        });

        // Pie Chart
        new Chart(document.getElementById('pieChart'), {
            type: 'pie',
            data: {
                labels: ['Valid', 'Suspicious', 'Invalid'],
                datasets: [{
                    data: [75, 15, 10],
                    backgroundColor: ['#3b82f6', '#f59e0b', '#ef4444']
                }]
            }
        });
    </script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
</body>

</html>





from flask import Flask, request, jsonify
import os
import zipfile
import pandas as pd
import cv2
from ultralytics import YOLO
import easyocr
from flask_cors import CORS
import torch

# from flask import Flask, request, jsonify
# from flask_cors import CORS

app = Flask(__name__)
CORS(app, resources={r"/process-files": {"origins": "http://localhost:8000"}})

# Model paths
CLASS_MODEL_PATH = "C:\\Users\\om\\Desktop\\INFOSYS_INTERNSHIP\\project\\AI\\models\\classificationbest.pt"
DETECT_MODEL_PATH = "C:\\Users\\om\\Desktop\\INFOSYS_INTERNSHIP\\project\\AI\\models\\detectionbest.pt"
# Verify models exist
if not all(os.path.exists(p) for p in [CLASS_MODEL_PATH, DETECT_MODEL_PATH]):
    raise FileNotFoundError("Model files missing!")

# Load models
classification_model = YOLO(CLASS_MODEL_PATH)
detection_model = YOLO(DETECT_MODEL_PATH)

# Initialize EasyOCR
reader = easyocr.Reader(['en'])

def classify_image(image_path):
    try:
        results = classification_model(image_path)
        if hasattr(results[0], 'probs'):
            probs = results[0].probs
            top1 = probs.top1
            top1_confidence = probs.top1conf.item()
            if top1 == 0 and top1_confidence >= 0.8:
                return "Aadhaar"
            else:
                return "Non-Aadhaar"
        return "Non-Aadhaar"
    except Exception as e:
        print(f"Classification error: {str(e)}")
        return "Error"

def detect_fields(image_path):
    try:
        results = detection_model(image_path)
        return [detection_model.names[int(box[5])] for result in results for box in result.boxes.data.tolist()] if results else []
    except Exception as e:
        print(f"Detection error: {str(e)}")
        return []

def extract_text(image_path, fields):
    try:
        image = cv2.imread(image_path)
        if image is None:
            return {}
        results = detection_model(image_path)
        extracted = {}
        for box in results[0].boxes.data.tolist():
            x1, y1, x2, y2 = map(int, box[:4])
            cropped = image[y1:y2, x1:x2]
            if cropped.size == 0:
                continue
            gray = cv2.cvtColor(cropped, cv2.COLOR_BGR2GRAY)
            text = reader.readtext(gray, detail=0)
            if text:
                extracted[detection_model.names[int(box[5])]] = ' '.join(text)
        return extracted
    except Exception as e:
        print(f"OCR error: {str(e)}")
        return {}

def calculate_score(extracted, excel):
    try:
        if not extracted:
            return 0
        matches = sum(1 for k in extracted if k in excel and extracted[k] == excel[k])
        return matches / len(extracted)
    except ZeroDivisionError:
        return 0

@app.route('/process-files', methods=['POST'])
def process_files():
    try:
        if 'zipFile' not in request.files or 'excelFile' not in request.files:
            return jsonify({"error": "Missing files"}), 400

        zip_file = request.files['zipFile']
        excel_file = request.files['excelFile']

        if not zip_file.filename.lower().endswith('.zip'):
            return jsonify({"error": "Invalid ZIP file"}), 400
        if not excel_file.filename.lower().endswith(('.xlsx', '.xls')):
            return jsonify({"error": "Invalid Excel file"}), 400

        UPLOAD_DIR = 'uploads'
        os.makedirs(UPLOAD_DIR, exist_ok=True)
        
        zip_path = os.path.join(UPLOAD_DIR, 'temp.zip')
        excel_path = os.path.join(UPLOAD_DIR, 'temp.xlsx')
        zip_file.save(zip_path)
        excel_file.save(excel_path)

        with zipfile.ZipFile(zip_path, 'r') as z:
            z.extractall(os.path.join(UPLOAD_DIR, 'extracted'))

        try:
            df = pd.read_excel(excel_path)
            excel_data = df.iloc[0].to_dict()
        except Exception as e:
            return jsonify({"error": f"Excel read error: {str(e)}"}), 400

        results = []
        for root, _, files in os.walk(os.path.join(UPLOAD_DIR, 'extracted')):
            for file in files:
                if file.lower().endswith(('.png', '.jpg', '.jpeg')):
                    img_path = os.path.join(root, file)
                    if classify_image(img_path) != "Aadhaar":
                        results.append({"file": file, "status": "Rejected", "reason": "Not Aadhaar"})
                        continue
                    extracted = extract_text(img_path, detect_fields(img_path))
                    score = calculate_score(extracted, excel_data)
                    results.append({
                        "file": file,
                        "status": "Verified" if score >= 0.8 else "Rejected",
                        "score": round(score, 2),
                        "reason": "" if score >= 0.8 else "Low match score"
                    })

        try:
            os.remove(zip_path)
            os.remove(excel_path)
            for root, dirs, files in os.walk(os.path.join(UPLOAD_DIR, 'extracted'), topdown=False):
                for name in files:
                    os.remove(os.path.join(root, name))
                for name in dirs:
                    os.rmdir(os.path.join(root, name))
            os.rmdir(os.path.join(UPLOAD_DIR, 'extracted'))
        except Exception as e:
            print(f"Cleanup error: {str(e)}")

        return jsonify(results)
    except Exception as e:
        print(f"Processing error: {str(e)}")
        return jsonify({"error": str(e)}), 500

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)






    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>AI.Tech - Artificial Intelligence HTML Template</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Ubuntu:wght@500;700&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
    <!-- Spinner Start -->
    <div id="spinner" class="d-none bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-grow text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <!-- Spinner End -->

    <!-- Navbar Start -->
    <div class="container-fluid sticky-top">
        <div class="container">
            <nav class="navbar navbar-expand-lg navbar-dark p-0">
                <a href="index.html" class="navbar-brand">
                    <h1 class="text-white">AI<span class="text-dark">.</span>Tech</h1>
                </a>
                <button type="button" class="navbar-toggler ms-auto me-0" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <div class="navbar-nav ms-auto">
                        <a href="index.html" class="nav-item nav-link">Home</a>
                        <a href="about.html" class="nav-item nav-link">About</a>
                        <a href="service.html" class="nav-item nav-link active">Services</a>
                        <a href="project.html" class="nav-item nav-link">Projects</a>
                        <div class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Pages</a>
                            <div class="dropdown-menu bg-light mt-2">
                                <a href="feature.html" class="dropdown-item">Features</a>
                                <a href="team.html" class="dropdown-item">Our Team</a>
                                <a href="faq.html" class="dropdown-item">FAQs</a>
                                <a href="testimonial.html" class="dropdown-item">Testimonial</a>
                                <a href="404.html" class="dropdown-item">404 Page</a>
                            </div>
                        </div>
                        <a href="contact.html" class="nav-item nav-link">Contact</a>
                    </div>
                    <button type="button" class="btn text-white p-0 d-none d-lg-block" data-bs-toggle="modal" data-bs-target="#searchModal"><i class="fa fa-search"></i></button>
                </div>
            </nav>
        </div>
    </div>
    <!-- Navbar End -->

    <!-- Hero Start -->
    <div class="container-fluid pt-5 bg-primary hero-header">
        <div class="container pt-5">
            <div class="row g-5 pt-5">
                <div class="col-lg-6 align-self-center text-center text-lg-start mb-lg-5">
                    <h1 class="display-4 text-white mb-4 animated slideInRight">Our Services</h1>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb justify-content-center justify-content-lg-start mb-0">
                            <li class="breadcrumb-item"><a class="text-white" href="#">Home</a></li>
                            <li class="breadcrumb-item"><a class="text-white" href="#">Pages</a></li>
                            <li class="breadcrumb-item text-white active" aria-current="page">Our Services</li>
                        </ol>
                    </nav>
                </div>
                <div class="col-lg-6 align-self-end text-center text-lg-end">
                    <img class="img-fluid" src="img/hero-img.png" alt="" style="max-height: 300px;">
                </div>
            </div>
        </div>
    </div>
    <!-- Hero End -->

    <!-- Full Screen Search Start -->
    <div class="modal fade" id="searchModal" tabindex="-1">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content" style="background: rgba(20, 24, 62, 0.7);">
                <div class="modal-header border-0">
                    <button type="button" class="btn btn-square bg-white btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body d-flex align-items-center justify-content-center">
                    <div class="input-group" style="max-width: 600px;">
                        <input type="text" class="form-control bg-transparent border-light p-3" placeholder="Type search keyword">
                        <button class="btn btn-light px-4"><i class="bi bi-search"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Full Screen Search End -->

    <!-- Service Start -->
    <div class="container-fluid bg-light py-5">
        <div class="container py-5">
            <!-- File Upload Section -->
            <div class="row mb-5">
                <div class="col-lg-8 wow fadeIn" data-wow-delay="0.1s">
                    <div class="btn btn-sm border rounded-pill text-primary px-3 mb-3">Our Services</div>
                    <h1 class="mb-4">Aadhar Fraud Management System</h1>
                    <p class="mb-4">Secure your Aadhar ecosystem with our AI-powered verification system. Upload required files to initiate automated fraud detection and validation process.</p>
                    
                    <!-- Form for File Upload -->
                    <form id="uploadForm" enctype="multipart/form-data">
                        <div class="row g-4">
                            <!-- Horizontal File Inputs -->
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Upload ZIP File (Images)</label>
                                <input type="file" class="form-control rounded-pill" name="zipFile" accept=".zip" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Upload Excel File (Mapping)</label>
                                <input type="file" class="form-control rounded-pill" name="excelFile" accept=".xlsx, .xls" required>
                            </div>
                            
                            <!-- Start Button -->
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary rounded-pill w-100 py-2">
                                    <i class="fa fa-play-circle me-2"></i>Start Verification
                                </button>
                            </div>
                        </div>
                    </form>

                    <!-- Download Section (Hidden by Default) -->
                    <div id="downloadSection" class="mt-4" style="display: none;">
                        <h5 class="mb-3">Processed File Ready for Download</h5>
                        <a id="downloadLink" class="btn btn-success rounded-pill w-100 py-2">
                            <i class="fa fa-download me-2"></i>Download Processed File
                        </a>
                    </div>
                </div>
            </div>

            <!-- Vertical Chart Sections -->
            <div class="row g-4">
                <!-- Aadhaar vs Non-Aadhaar Bar Chart -->
                <div class="col-12 wow fadeIn" data-wow-delay="0.2s">
                    <div class="card border-0 shadow h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="card-title mb-0">Accepted vs Rejected Documents</h5>
                                <button class="btn btn-outline-primary">
                                    <i class="fa fa-download me-2"></i>Download Report
                                </button>
                            </div>
                            <div style="height: 300px">
                                <canvas id="barChart1"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pie Chart Section -->
                <div class="col-12 wow fadeIn" data-wow-delay="0.6s">
                    <div class="card border-0 shadow h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="card-title mb-0">Document Status Distribution</h5>
                                <button class="btn btn-outline-primary">
                                    <i class="fa fa-download me-2"></i>Download Report
                                </button>
                            </div>
                            <div style="height: 300px">
                                <canvas id="pieChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Table Section -->
            <div class="row mt-5 wow fadeIn" data-wow-delay="0.8s">
                <div class="col-12">
                    <div class="card border-0 shadow">
                        <div id="resultsSection" class="card-body d-none">
                            <h5 class="card-title mb-4">Verification Results</h5>
                            <div class="table-responsive">
                                <table id="verificationTable" class="table table-bordered table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Sr. No</th>
                                            <th>Accept/Reject Status</th>
                                            <th>Document Type</th>
                                            <th>Final Remark</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Results will be dynamically populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Service End -->

    <!-- Footer Start -->
    <div class="container-fluid bg-dark text-white-50 footer pt-5">
        <div class="container py-5">
            <div class="row g-5">
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.1s">
                    <a href="index.html" class="d-inline-block mb-3">
                        <h1 class="text-white">AI<span class="text-primary">.</span>Tech</h1>
                    </a>
                    <p class="mb-0">The AI-Based Fraud Management System for UID Aadhaar is a cutting-edge solution designed to safeguard India's Aadhaar ecosystem.</p>
                </div>
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.3s">
                    <h5 class="text-white mb-4">Get In Touch</h5>
                    <p><i class="fa fa-map-marker-alt me-3"></i>123 Street, New York, USA</p>
                    <p><i class="fa fa-phone-alt me-3"></i>+012 345 67890</p>
                    <p><i class="fa fa-envelope me-3"></i>info@example.com</p>
                </div>
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.5s">
                    <h5 class="text-white mb-4">Popular Link</h5>
                    <a class="btn btn-link" href="about.html">About Us</a>
                    <a class="btn btn-link" href="contact.html">Contact Us</a>
                </div>
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.7s">
                    <h5 class="text-white mb-4">Our Services</h5>
                    <a class="btn btn-link" href="">Robotic Automation</a>
                    <a class="btn btn-link" href="">Machine learning</a>
                </div>
            </div>
        </div>
        <div class="container wow fadeIn" data-wow-delay="0.1s">
            <div class="copyright">
                <div class="row">
                    <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                        © <a class="border-bottom" href="#">AI.Tech</a>, All Right Reserved.
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top pt-2"><i class="bi bi-arrow-up"></i></a>

    <!-- JavaScript Libraries -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/counterup/counterup.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- JavaScript for Form Submission and Charts -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let pieChart, barChart; // Declare chart instances

            document.getElementById('uploadForm').addEventListener('submit', function (e) {
                e.preventDefault(); // Prevent default form submission

                // Show spinner
                document.getElementById('spinner').classList.remove('d-none');

                // Collect form data
                const formData = new FormData(this);

                // Send fetch request to the backend
                fetch('http://127.0.0.1:5000/process-files', {
                    method: 'POST',
                    body: formData
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Server error: ' + response.statusText);
                    }
                    return response.json();
                })
                .then(data => {
                    document.getElementById('spinner').classList.add('d-none');

                    // Calculate counts for charts
                    const acceptedCount = data.filter(item => item.status === 'Verified').length;
                    const rejectedCount = data.filter(item => item.status === 'Rejected').length;

                    // Destroy existing charts if they exist
                    if (pieChart) pieChart.destroy();
                    if (barChart) barChart.destroy();

                    // Create Pie Chart
                    pieChart = new Chart(document.getElementById('pieChart'), {
                        type: 'pie',
                        data: {
                            labels: ['Accepted', 'Rejected'],
                            datasets: [{
                                data: [acceptedCount, rejectedCount],
                                backgroundColor: ['#3b82f6', '#ef4444']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });

                    // Create Bar Chart
                    barChart = new Chart(document.getElementById('barChart1'), {
                        type: 'bar',
                        data: {
                            labels: ['Accepted', 'Rejected'],
                            datasets: [{
                                label: 'Document Count',
                                data: [acceptedCount, rejectedCount],
                                backgroundColor: ['#3b82f6', '#ef4444']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });

                    // Populate table
                    const tbody = document.querySelector('#verificationTable tbody');
                    tbody.innerHTML = '';
                    data.forEach((item, index) => {
                        const row = tbody.insertRow();
                        row.insertCell().textContent = index + 1;

                        const statusCell = row.insertCell();
                        const statusBadge = document.createElement('span');
                        statusBadge.className = item.status === 'Verified' ? 'badge bg-success' : 'badge bg-danger';
                        statusBadge.textContent = item.status;
                        statusCell.appendChild(statusBadge);

                        const documentType = item.status === 'Verified' ? 'Aadhaar' : 'Non-Aadhaar';
                        row.insertCell().textContent = documentType;

                        row.insertCell().textContent = item.reason || (item.status === 'Verified' ? 'Validation Successful' : 'Validation Failed');
                    });

                    // Show results section
                    document.getElementById('resultsSection').classList.remove('d-none');
                })
                .catch(error => {
                    document.getElementById('spinner').classList.add('d-none');
                    alert('Error processing files: ' + error.message);
                });
            });
        });
    </script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
</body>
</html>
























//2

from flask import Flask, request, jsonify
import os
import zipfile
import pandas as pd
import cv2
from ultralytics import YOLO
import easyocr
from flask_cors import CORS
import logging

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

app = Flask(__name__)
CORS(app, resources={r"/process-files": {"origins": "http://localhost:8000"}})

# Model paths
CLASS_MODEL_PATH = "C:\\Users\\om\\Desktop\\INFOSYS_INTERNSHIP\\project\\AI\\models\\classificationbest.pt"
DETECT_MODEL_PATH = "C:\\Users\\om\\Desktop\\INFOSYS_INTERNSHIP\\project\\AI\\models\\detectionbest.pt"

# Verify models exist
if not all(os.path.exists(p) for p in [CLASS_MODEL_PATH, DETECT_MODEL_PATH]):
    raise FileNotFoundError("Model files missing!")

# Load models
classification_model = YOLO(CLASS_MODEL_PATH)
detection_model = YOLO(DETECT_MODEL_PATH)

# Initialize EasyOCR
reader = easyocr.Reader(['en'])

def classify_image(image_path):
    """
    Classify an image as Aadhaar or Non-Aadhaar using the classification model.

    Args:
        image_path (str): Path to the image file.

    Returns:
        str: "Aadhaar", "Non-Aadhaar", or "Error".
    """
    try:
        results = classification_model(image_path)
        if hasattr(results[0], 'probs'):
            probs = results[0].probs
            top1 = probs.top1
            top1_confidence = probs.top1conf.item()
            if top1 == 0 and top1_confidence >= 0.4:
                return "Aadhaar"
            return "Non-Aadhaar"
        return "Non-Aadhaar"
    except Exception as e:
        logger.error(f"Classification error: {str(e)}")
        return "Error"

def detect_fields(image_path):
    """
    Detect fields in an image using the detection model.

    Args:
        image_path (str): Path to the image file.

    Returns:
        list: List of detected field names.
    """
    try:
        results = detection_model(image_path)
        return [detection_model.names[int(box[5])] for result in results for box in result.boxes.data.tolist()] if results else []
    except Exception as e:
        logger.error(f"Detection error: {str(e)}")
        return []

def extract_text(image_path, fields):
    """
    Extract text from detected fields in an image.

    Args:
        image_path (str): Path to the image file.
        fields (list): List of detected field names.

    Returns:
        dict: Dictionary of field names and extracted text.
    """
    try:
        image = cv2.imread(image_path)
        if image is None:
            logger.error(f"Image not found or unreadable: {image_path}")
            return {}
        results = detection_model(image_path)
        extracted = {}
        for box in results[0].boxes.data.tolist():
            x1, y1, x2, y2 = map(int, box[:4])
            cropped = image[y1:y2, x1:x2]
            if cropped.size == 0:
                continue
            gray = cv2.cvtColor(cropped, cv2.COLOR_BGR2GRAY)
            text = reader.readtext(gray, detail=0)
            if text:
                extracted[detection_model.names[int(box[5])]] = ' '.join(text)
        logger.info(f"Extracted text from {image_path}: {extracted}")
        return extracted
    except Exception as e:
        logger.error(f"OCR error: {str(e)}")
        return {}

def split_address(address):
    """
    Split address into components based on common patterns.

    Args:
        address (str): Address string to split.

    Returns:
        dict: Dictionary of address components.
    """
    components = {
        'House Flat Number': '',
        'Town': '',
        'Street Road Name': '',
        'City': '',
        'Floor Number': '',
        'Country': 'India',  # Default for Aadhaar
        'PINCODE': '',
        'Premise Building Name': '',
        'Landmark': '',
        'State': ''
    }
    if not address or not isinstance(address, str):
        return components
    
    parts = address.split(',')
    for part in parts:
        part = part.strip()
        if not part:
            continue
        if 'Flat' in part or 'House' in part or any(c.isdigit() for c in part):
            components['House Flat Number'] = part
        elif any(c.isdigit() for c in part) and len(''.join(filter(str.isdigit, part))) == 6:
            components['PINCODE'] = ''.join(filter(str.isdigit, part))
        elif 'Noida' in part or 'Pune' in part or 'Town' in part:
            components['Town'] = components['City'] = part
        elif 'Road' in part or 'Street' in part:
            components['Street Road Name'] = part
        elif 'Tower' in part or 'Building' in part:
            components['Premise Building Name'] = part
        elif 'Park' in part or 'Near' in part:
            components['Landmark'] = part
        elif 'Uttar Pradesh' in part or 'Maharashtra' in part:
            components['State'] = part
        elif 'Floor' in part or 'th' in part or 'nd' in part or 'rd' in part:
            components['Floor Number'] = part
    return components

def calculate_match_score(extracted, excel_row, available_columns):
    """
    Calculate match scores for fields based on extracted OCR data and Excel row.

    Args:
        extracted (dict): Extracted text from the image.
        excel_row (pd.Series): Row from the Excel file.
        available_columns (list): List of columns available in the Excel file.

    Returns:
        dict: Dictionary of match scores and final remarks.
    """
    scores = {
        'House Flat Number Match Score': 0,
        'Town Match Score': 0,
        'Street Road Name Match Score': 0,
        'City Match Score': 0,
        'Floor Number Match Score': 0,
        'PINCODE Match Score': 0,
        'Premise Building Name Match Score': 0,
        'Landmark Match Score': 0,
        'State Match Score': 0,
        'Name Match Score': 0,
        'UID Match Score': 0,
        'Final Address Match Score': 0,
        'Overall Match': 0,
        'Final Remarks': 'Rejected',
        'Document Type': 'Aadhaar'
    }

    if 'Address' in extracted:
        address_components = split_address(extracted['Address'])
    else:
        address_components = {}

    excel_fields = {field: str(excel_row.get(field, '')).strip() for field in available_columns}
    
    if 'Name' in extracted and 'Name' in available_columns:
        extracted_name = extracted['Name'].strip().lower()
        excel_name = excel_fields['Name'].lower()
        scores['Name Match Score'] = 10 if extracted_name == excel_name else 0

    if 'UID' in extracted and 'UID' in available_columns:
        extracted_uid = extracted['UID'].strip()
        excel_uid = excel_fields['UID']
        scores['UID Match Score'] = 10 if extracted_uid == excel_uid else 0

    address_fields = ['House Flat Number', 'Town', 'Street Road Name', 'City', 'Floor Number', 
                     'PINCODE', 'Premise Building Name', 'Landmark', 'State']
    address_match_sum = 0
    total_address_fields = 0
    
    for field in address_fields:
        if field in available_columns:
            excel_value = excel_fields.get(field, '').lower()
            extracted_value = address_components.get(field, '').lower()
            if excel_value or extracted_value:
                total_address_fields += 1
                match = extracted_value == excel_value if excel_value and extracted_value else False
                scores[f'{field} Match Score'] = 10 if match else 0
                if match:
                    address_match_sum += 1

    if total_address_fields > 0:
        scores['Final Address Match Score'] = (address_match_sum / total_address_fields * 10)
    
    total_possible_score = 10 + 10 + (total_address_fields * 10)
    total_score = scores['Name Match Score'] + scores['UID Match Score'] + scores['Final Address Match Score']
    if total_possible_score > 0:
        scores['Overall Match'] = (total_score / total_possible_score * 100)

    scores['Final Remarks'] = 'Verified' if scores['Overall Match'] >= 80 else 'Rejected'
    logger.info(f"Match scores: {scores}")
    return scores

@app.route('/process-files', methods=['POST'])
def process_files():
    """
    Process uploaded ZIP and Excel files, matching images to Excel data.

    Returns:
        JSON response with processing results or error message.
    """
    try:
        if 'zipFile' not in request.files or 'excelFile' not in request.files:
            logger.error("Missing files in request")
            return jsonify({"error": "Missing files"}), 400

        zip_file = request.files['zipFile']
        excel_file = request.files['excelFile']

        if not zip_file.filename.lower().endswith('.zip') or not excel_file.filename.lower().endswith(('.xlsx', '.xls')):
            logger.error("Invalid file format")
            return jsonify({"error": "Invalid file format"}), 400

        UPLOAD_DIR = 'uploads'
        os.makedirs(UPLOAD_DIR, exist_ok=True)
        
        zip_path = os.path.join(UPLOAD_DIR, 'temp.zip')
        excel_path = os.path.join(UPLOAD_DIR, 'temp.xlsx')
        zip_file.save(zip_path)
        excel_file.save(excel_path)

        with zipfile.ZipFile(zip_path, 'r') as z:
            z.extractall(os.path.join(UPLOAD_DIR, 'extracted'))

        df = pd.read_excel(excel_path)
        available_columns = df.columns.tolist()
        logger.info(f"Available Excel columns: {available_columns}")

        results = []
        for root, _, files in os.walk(os.path.join(UPLOAD_DIR, 'extracted')):
            for file in files:
                if file.lower().endswith(('.png', '.jpg', '.jpeg')):
                    img_path = os.path.join(root, file)
                    if classify_image(img_path) != "Aadhaar":
                        results.append({"file": file, "status": "Rejected", "reason": "Not Aadhaar"})
                        continue
                    extracted = extract_text(img_path, detect_fields(img_path))
                    # Placeholder for future image description processing
                    # Example: image_description = process_image_description(img_path)
                    # if image_description:
                    #     extracted.update(image_description)
                    for _, row in df.iterrows():
                        scores = calculate_match_score(extracted, row, available_columns)
                        results.append({
                            "file": file,
                            "status": scores['Final Remarks'],
                            "score": round(scores['Overall Match'], 2),
                            "reason": "" if scores['Final Remarks'] == 'Verified' else "Low match score",
                            "details": scores
                        })
                        break  # Match one row per image

        # Cleanup
        os.remove(zip_path)
        os.remove(excel_path)
        for root, dirs, files in os.walk(os.path.join(UPLOAD_DIR, 'extracted'), topdown=False):
            for name in files:
                os.remove(os.path.join(root, name))
            for name in dirs:
                os.rmdir(os.path.join(root, name))
        os.rmdir(os.path.join(UPLOAD_DIR, 'extracted'))

        logger.info(f"Processing completed: {results}")
        return jsonify(results)
    except Exception as e:
        logger.error(f"Processing error: {str(e)}")
        return jsonify({"error": str(e)}), 500

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)








    //day 2 js code running
    <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>AI.Tech - Artificial Intelligence HTML Template</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Ubuntu:wght@500;700&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">

    <!-- SheetJS Library for Excel Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <!-- Spinner Start -->
    <div id="spinner" class="d-none bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-grow text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <!-- Spinner End -->

    <!-- Navbar Start -->
    <div class="container-fluid sticky-top">
        <div class="container">
            <nav class="navbar navbar-expand-lg navbar-dark p-0">
                <a href="index.html" class="navbar-brand">
                    <h1 class="text-white">AI<span class="text-dark">.</span>Tech</h1>
                </a>
                <button type="button" class="navbar-toggler ms-auto me-0" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <div class="navbar-nav ms-auto">
                        <a href="index.html" class="nav-item nav-link">Home</a>
                        <a href="about.html" class="nav-item nav-link">About</a>
                        <a href="service.html" class="nav-item nav-link active">Services</a>
                        <a href="project.html" class="nav-item nav-link">Projects</a>
                        <div class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Pages</a>
                            <div class="dropdown-menu bg-light mt-2">
                                <a href="feature.html" class="dropdown-item">Features</a>
                                <a href="team.html" class="dropdown-item">Our Team</a>
                                <a href="faq.html" class="dropdown-item">FAQs</a>
                                <a href="testimonial.html" class="dropdown-item">Testimonial</a>
                                <a href="404.html" class="dropdown-item">404 Page</a>
                            </div>
                        </div>
                        <a href="contact.html" class="nav-item nav-link">Contact</a>
                    </div>
                    <button type="button" class="btn text-white p-0 d-none d-lg-block" data-bs-toggle="modal" data-bs-target="#searchModal"><i class="fa fa-search"></i></button>
                </div>
            </nav>
        </div>
    </div>
    <!-- Navbar End -->

    <!-- Hero Start -->
    <div class="container-fluid pt-5 bg-primary hero-header">
        <div class="container pt-5">
            <div class="row g-5 pt-5">
                <div class="col-lg-6 align-self-center text-center text-lg-start mb-lg-5">
                    <h1 class="display-4 text-white mb-4 animated slideInRight">Our Services</h1>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb justify-content-center justify-content-lg-start mb-0">
                            <li class="breadcrumb-item"><a class="text-white" href="#">Home</a></li>
                            <li class="breadcrumb-item"><a class="text-white" href="#">Pages</a></li>
                            <li class="breadcrumb-item text-white active" aria-current="page">Our Services</li>
                        </ol>
                    </nav>
                </div>
                <div class="col-lg-6 align-self-end text-center text-lg-end">
                    <img class="img-fluid" src="img/hero-img.png" alt="" style="max-height: 300px;">
                </div>
            </div>
        </div>
    </div>
    <!-- Hero End -->

    <!-- Full Screen Search Start -->
    <div class="modal fade" id="searchModal" tabindex="-1">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content" style="background: rgba(20, 24, 62, 0.7);">
                <div class="modal-header border-0">
                    <button type="button" class="btn btn-square bg-white btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body d-flex align-items-center justify-content-center">
                    <div class="input-group" style="max-width: 600px;">
                        <input type="text" class="form-control bg-transparent border-light p-3" placeholder="Type search keyword">
                        <button class="btn btn-light px-4"><i class="bi bi-search"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Full Screen Search End -->

    <!-- Service Start -->
    <div class="container-fluid bg-light py-5">
        <div class="container py-5">
            <!-- File Upload Section -->
            <div class="row mb-5">
                <div class="col-lg-8 wow fadeIn" data-wow-delay="0.1s">
                    <div class="btn btn-sm border rounded-pill text-primary px-3 mb-3">Our Services</div>
                    <h1 class="mb-4">Aadhar Fraud Management System</h1>
                    <p class="mb-4">Secure your Aadhar ecosystem with our AI-powered verification system. Upload required files to initiate automated fraud detection and validation process.</p>
                    
                    <!-- Form for File Upload -->
                    <form id="uploadForm" enctype="multipart/form-data">
                        <div class="row g-4">
                            <!-- Horizontal File Inputs -->
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Upload ZIP File (Images)</label>
                                <input type="file" class="form-control rounded-pill" name="zipFile" accept=".zip" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Upload Excel File (Mapping)</label>
                                <input type="file" class="form-control rounded-pill" name="excelFile" accept=".xlsx, .xls" required>
                            </div>
                            
                            <!-- Start Button -->
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary rounded-pill w-100 py-2">
                                    <i class="fa fa-play-circle me-2"></i>Start Verification
                                </button>
                            </div>
                        </div>
                    </form>

                    <!-- Download Section (Hidden by Default) -->
                    <div id="downloadSection" class="mt-4" style="display: none;">
                        <h5 class="mb-3">Processed File Ready for Download</h5>
                        <a id="downloadLink" class="btn btn-success rounded-pill w-100 py-2">
                            <i class="fa fa-download me-2"></i>Download Processed File
                        </a>
                    </div>
                </div>
            </div>

            <!-- Vertical Chart Sections -->
            <div class="row g-4">
                <!-- Aadhaar vs Non-Aadhaar Bar Chart -->
                <div class="col-12 wow fadeIn" data-wow-delay="0.2s">
                    <div class="card border-0 shadow h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="card-title mb-0">Accepted vs Rejected Documents</h5>
                                <button class="btn btn-outline-primary">
                                    <i class="fa fa-download me-2"></i>Download Report
                                </button>
                            </div>
                            <div style="height: 300px">
                                <canvas id="barChart1"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pie Chart Section -->
                <div class="col-12 wow fadeIn" data-wow-delay="0.6s">
                    <div class="card border-0 shadow h-100">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="card-title mb-0">Document Status Distribution</h5>
                                <button class="btn btn-outline-primary">
                                    <i class="fa fa-download me-2"></i>Download Report
                                </button>
                            </div>
                            <div style="height: 300px">
                                <canvas id="pieChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Table Section -->
            <div class="row mt-5 wow fadeIn" data-wow-delay="0.8s">
                <div class="col-12">
                    <div class="card border-0 shadow">
                        <div id="resultsSection" class="card-body d-none">
                            <h5 class="card-title mb-4">Verification Results</h5>
                            <div class="table-responsive">
                                <table id="verificationTable" class="table table-bordered table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Sr. No</th>
                                            <th>File Name</th>
                                            <th>Accept/Reject Status</th>
                                            <th>Document Type</th>
                                            <th>Final Remark</th>
                                            <th>Match Score</th>
                                            <th>Name (Excel)</th>
                                            <th>UID (Excel)</th>
                                            <th>Address (Excel)</th>
                                            <th>Name Extracted</th>
                                            <th>UID Extracted</th>
                                            <th>Address Extracted</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Results will be dynamically populated here -->
                                    </tbody>
                                </table>
                            </div>
                            <!-- Download Excel Button -->
                            <button id="downloadExcel" class="btn btn-primary mt-3">Download as Excel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Service End -->

    <!-- Footer Start -->
    <div class="container-fluid bg-dark text-white-50 footer pt-5">
        <div class="container py-5">
            <div class="row g-5">
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.1s">
                    <a href="index.html" class="d-inline-block mb-3">
                        <h1 class="text-white">AI<span class="text-primary">.</span>Tech</h1>
                    </a>
                    <p class="mb-0">The AI-Based Fraud Management System for UID Aadhaar is a cutting-edge solution designed to safeguard India's Aadhaar ecosystem.</p>
                </div>
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.3s">
                    <h5 class="text-white mb-4">Get In Touch</h5>
                    <p><i class="fa fa-map-marker-alt me-3"></i>123 Street, New York, USA</p>
                    <p><i class="fa fa-phone-alt me-3"></i>+012 345 67890</p>
                    <p><i class="fa fa-envelope me-3"></i>info@example.com</p>
                </div>
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.5s">
                    <h5 class="text-white mb-4">Popular Link</h5>
                    <a class="btn btn-link" href="about.html">About Us</a>
                    <a class="btn btn-link" href="contact.html">Contact Us</a>
                </div>
                <div class="col-md-6 col-lg-3 wow fadeIn" data-wow-delay="0.7s">
                    <h5 class="text-white mb-4">Our Services</h5>
                    <a class="btn btn-link" href="">Robotic Automation</a>
                    <a class="btn btn-link" href="">Machine learning</a>
                </div>
            </div>
        </div>
        <div class="container wow fadeIn" data-wow-delay="0.1s">
            <div class="copyright">
                <div class="row">
                    <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                        © <a class="border-bottom" href="#">AI.Tech</a>, All Right Reserved.
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top pt-2"><i class="bi bi-arrow-up"></i></a>

    <!-- JavaScript Libraries -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/counterup/counterup.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Updated JavaScript for Form Submission, Charts, and Excel Download -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let pieChart, barChart;
            let verificationData; // To store the data for Excel download

            document.getElementById('uploadForm').addEventListener('submit', function (e) {
                e.preventDefault();

                const zipFileInput = document.querySelector('input[name="zipFile"]');
                const excelFileInput = document.querySelector('input[name="excelFile"]');

                if (!zipFileInput.files.length || !excelFileInput.files.length) {
                    alert('Please select both a ZIP file and an Excel file before submitting.');
                    return;
                }

                const zipFile = zipFileInput.files[0];
                const excelFile = excelFileInput.files[0];
                if (!zipFile.name.endsWith('.zip')) {
                    alert('Please upload a valid ZIP file.');
                    return;
                }
                if (!excelFile.name.endsWith('.xlsx') && !excelFile.name.endsWith('.xls')) {
                    alert('Please upload a valid Excel file (.xlsx or .xls).');
                    return;
                }

                document.getElementById('spinner').classList.remove('d-none');

                const formData = new FormData(this);

                fetch('http://127.0.0.1:5000/process-files', {
                    method: 'POST',
                    body: formData
                })
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(data => {
                            throw new Error(data.error || 'Server error');
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    document.getElementById('spinner').classList.add('d-none');

                    // Calculate counts for charts
                    const acceptedCount = data.filter(item => item.status === 'Verified').length;
                    const rejectedCount = data.filter(item => item.status === 'Rejected').length;

                    if (pieChart) pieChart.destroy();
                    if (barChart) barChart.destroy();

                    pieChart = new Chart(document.getElementById('pieChart'), {
                        type: 'pie',
                        data: {
                            labels: ['Accepted', 'Rejected'],
                            datasets: [{
                                data: [acceptedCount, rejectedCount],
                                backgroundColor: ['#3b82f6', '#ef4444']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });

                    barChart = new Chart(document.getElementById('barChart1'), {
                        type: 'bar',
                        data: {
                            labels: ['Accepted', 'Rejected'],
                            datasets: [{
                                label: 'Document Count',
                                data: [acceptedCount, rejectedCount],
                                backgroundColor: ['#3b82f6', '#ef4444']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: { beginAtZero: true }
                            }
                        }
                    });

                    // Populate the table rows
                    const tbody = document.querySelector('#verificationTable tbody');
                    tbody.innerHTML = '';
                    data.forEach((item, index) => {
                        const row = tbody.insertRow();
                        row.insertCell().textContent = index + 1; // Sr. No
                        row.insertCell().textContent = item.file; // File Name

                        const statusCell = row.insertCell();
                        const statusBadge = document.createElement('span');
                        statusBadge.className = item.status === 'Verified' ? 'badge bg-success' : 'badge bg-danger';
                        statusBadge.textContent = item.status;
                        statusCell.appendChild(statusBadge);

                        const documentType = item.reason === "Not Aadhaar" ? "Non-Aadhaar" : "Aadhaar";
                        row.insertCell().textContent = documentType;

                        row.insertCell().textContent = item.reason || (item.status === 'Verified' ? 'Validation Successful' : 'Validation Failed');

                        row.insertCell().textContent = item.score !== undefined ? `${(item.score * 100).toFixed(0)}%` : ''; // Match Score

                        // Excel data
                        row.insertCell().textContent = item.excel_data?.Name || '';
                        row.insertCell().textContent = item.excel_data?.UID || '';
                        row.insertCell().textContent = item.excel_data?.Address || '';

                        // Extracted data
                        row.insertCell().textContent = item.extracted?.Name || '';
                        row.insertCell().textContent = item.extracted?.UID || '';
                        row.insertCell().textContent = item.extracted?.Address || '';
                    });

                    // Prepare data for Excel download
                    verificationData = data.map((item, index) => ({
                        "Sr. No": index + 1,
                        "File Name": item.file,
                        "Accept/Reject Status": item.status,
                        "Document Type": item.reason === "Not Aadhaar" ? "Non-Aadhaar" : "Aadhaar",
                        "Final Remark": item.reason || (item.status === 'Verified' ? 'Validation Successful' : 'Validation Failed'),
                        "Match Score": item.score !== undefined ? `${(item.score * 100).toFixed(0)}%` : '',
                        "Name (Excel)": item.excel_data?.Name || '',
                        "UID (Excel)": item.excel_data?.UID || '',
                        "Address (Excel)": item.excel_data?.Address || '',
                        "Name Extracted": item.extracted?.Name || '',
                        "UID Extracted": item.extracted?.UID || '',
                        "Address Extracted": item.extracted?.Address || ''
                    }));

                    document.getElementById('resultsSection').classList.remove('d-none');
                })
                .catch(error => {
                    document.getElementById('spinner').classList.add('d-none');
                    alert('Error processing files: ' + error.message);
                });
            });

            // Event listener for Excel download button
            document.getElementById('downloadExcel').addEventListener('click', function() {
                if (verificationData) {
                    const worksheet = XLSX.utils.json_to_sheet(verificationData);
                    const workbook = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(workbook, worksheet, "Verification Results");
                    XLSX.writeFile(workbook, 'verification_results.xlsx');
                } else {
                    alert('No data available to download. Please process the files first.');
                }
            });
        });
    </script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
</body>
</html>